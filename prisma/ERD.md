# ER Diagram
> Generated by [`prisma-markdown`](https://github.com/samchon/prisma-markdown)

- [default](#default)

## default
```mermaid
erDiagram
"Account" {
  String id PK
  String user_id FK
  String type
  String provider
  String provider_account_id
  String refresh_token "nullable"
  String access_token "nullable"
  Int expires_at "nullable"
  String token_type "nullable"
  String scope "nullable"
  String id_token "nullable"
  String session_state "nullable"
}
"Session" {
  String id PK
  String session_token UK
  String user_id FK
  DateTime expires
}
"VerificationToken" {
  String identifier
  String token
  DateTime expires
}
"User" {
  String id PK
  String slug UK
  String name
  String email UK
  DateTime email_verified "nullable"
  String image "nullable"
  UserStatus status
  String description "nullable"
  String roleId FK
  DateTime verifiedAt "nullable"
  DateTime createdAt
  DateTime updatedAt
}
"UserRole" {
  String id PK
  String name
  String permissions
  DateTime createdAt
  DateTime updatedAt
}
"Workspace" {
  String id PK
  String slug UK
  String name
  String description "nullable"
  DateTime createdAt
  DateTime updatedAt
}
"WorkspaceMember" {
  String id PK
  String userId FK
  String workspaceId FK
  String role
  DateTime joinedAt
  DateTime leavedAt "nullable"
}
"Channel" {
  String id PK
  String slug UK
  String workspaceId FK
  String creatorId FK "nullable"
  String description "nullable"
  ChannelType type
  DateTime createdAt
  DateTime updatedAt
}
"Thread" {
  String id PK
  String parentChannelId FK
  String creatorId FK
  String messageId FK
  String title
  String description "nullable"
  DateTime createdAt
  DateTime updatedAt
}
"ThreadMember" {
  String threadId FK
  String userId FK
  DateTime createdAt
}
"ChannelMember" {
  String userId FK
  String channelId FK
  ChannelMemberRole role
  String categoryId FK "nullable"
  Int displayOrder
  DateTime joinedAt
  DateTime lastAccessedAt
}
"ChannelCategory" {
  String id PK
  String name
  String userId FK
  String workspaceId FK
  DateTime createdAt
  DateTime updatedAt
}
"Message" {
  String id PK
  String channelId FK
  String threadId FK "nullable"
  String userId FK
  String content
  MessageType type
  DateTime createdAt
  DateTime updatedAt
}
"Asset" {
  String id PK
  String messageId FK
  String alt "nullable"
  AssetType type
  String url
  DateTime createdAt
}
"Reaction" {
  String messageId FK
  String userId FK
  String emoji
  DateTime createdAt
}
"PinnedMessage" {
  String channelId FK
  String messageId FK
  String pinnedBy FK
  DateTime pinnedAt
}
"Bookmark" {
  String userId FK
  String messageId FK
  DateTime createdAt
}
"Mention" {
  String messageId FK
  String mentionedUserId FK
  DateTime createdAt
}
"CustomEmoji" {
  String id PK
  String workspaceId FK
  String name
  String url
  DateTime createdAt
}
"MessageLink" {
  String id PK
  String messageId FK
  String url
  String title "nullable"
  String description "nullable"
  String ogImageUrl "nullable"
  DateTime createdAt
  DateTime updatedAt
}
"_MessageToThread" {
  String A FK
  String B FK
}
"Account" }o--|| "User" : user
"Session" }o--|| "User" : user
"User" }o--|| "UserRole" : role
"WorkspaceMember" }o--|| "User" : user
"WorkspaceMember" }o--|| "Workspace" : workspace
"Channel" }o--|| "Workspace" : workspace
"Channel" }o--o| "User" : creator
"Thread" }o--|| "Channel" : parentChannel
"Thread" }o--|| "User" : creator
"Thread" }o--|| "Message" : message
"ThreadMember" }o--|| "Thread" : thread
"ThreadMember" }o--|| "User" : user
"ChannelMember" }o--|| "User" : user
"ChannelMember" }o--|| "Channel" : channel
"ChannelMember" }o--o| "ChannelCategory" : category
"ChannelCategory" }o--|| "User" : user
"ChannelCategory" }o--|| "Workspace" : workspace
"Message" }o--|| "Channel" : channel
"Message" }o--o| "Thread" : thread
"Message" }o--|| "User" : user
"Asset" }o--|| "Message" : message
"Reaction" }o--|| "Message" : message
"Reaction" }o--|| "User" : user
"PinnedMessage" }o--|| "Channel" : channel
"PinnedMessage" }o--|| "Message" : message
"PinnedMessage" }o--|| "User" : pinnedByUser
"Bookmark" }o--|| "User" : user
"Bookmark" }o--|| "Message" : message
"Mention" }o--|| "Message" : message
"Mention" }o--|| "User" : mentionedUser
"CustomEmoji" }o--|| "Workspace" : workspace
"MessageLink" }o--|| "Message" : message
"_MessageToThread" }o--|| "Message" : Message
"_MessageToThread" }o--|| "Thread" : Thread
```

### `Account`
*
 * Google OAuthのアカウントを管理するテーブル。Auth.js用

**Properties**
  - `id`: 
  - `user_id`: 
  - `type`: 
  - `provider`: 
  - `provider_account_id`: 
  - `refresh_token`: 
  - `access_token`: 
  - `expires_at`: 
  - `token_type`: 
  - `scope`: 
  - `id_token`: 
  - `session_state`: 

### `Session`
*
 * ログインユーザーのセッションを管理するテーブル。Auth.js用

**Properties**
  - `id`: 
  - `session_token`: 
  - `user_id`: 
  - `expires`: 

### `VerificationToken`
*
 * Auth.js用

**Properties**
  - `identifier`: 
  - `token`: 
  - `expires`: 

### `User`
*
 * Digichatユーザーを管理するテーブル

**Properties**
  - `id`: 
  - `slug`: ユーザーが自由に設定できる一意なID
  - `name`: 表示名
  - `email`: 大学のGmailアカウント。sicなし
  - `email_verified`: 
  - `image`: アイコン画像のURL
  - `status`: オンライン状態
  - `description`: 自己紹介
  - `roleId`: 
  - `verifiedAt`: 
  - `createdAt`: 
  - `updatedAt`: 

### `UserRole`
*
 * ユーザーのロールを管理するテーブル。Discordのロールに相当する

**Properties**
  - `id`: 
  - `name`: 
  - `permissions`: 一旦ADMIN, MODERATOR, USERのいずれかを設定する。ADMINはインフラ部員、MODERATORは幹部
  - `createdAt`: 
  - `updatedAt`: 

### `Workspace`
*
 * ワークスペースを管理するテーブル

**Properties**
  - `id`: 
  - `slug`: 
  - `name`: 
  - `description`: 
  - `createdAt`: 
  - `updatedAt`: 

### `WorkspaceMember`

**Properties**
  - `id`: 
  - `userId`: ユーザーテーブルのユーザーと紐づける。同一のユーザーが複数のワークスペースに参加できる
  - `workspaceId`: 
  - `role`: 
  - `joinedAt`: 
  - `leavedAt`: 

### `Channel`

**Properties**
  - `id`: 自動生成されるID。URLにはこれを使用する
  - `slug`: ユーザーが直接目にするチャンネルの名前
  - `workspaceId`: 
  - `creatorId`: 
  - `description`: 
  - `type`: 
  - `createdAt`: 
  - `updatedAt`: 

### `Thread`

**Properties**
  - `id`: 
  - `parentChannelId`: 
  - `creatorId`: 
  - `messageId`: スレッドの最初のメッセージ
  - `title`: スレッドのタイトル。デフォルトは最初のメッセージとし、あとから変更可能
  - `description`: スレッドの説明。デフォルトはnullとし、あとから変更可能
  - `createdAt`: 
  - `updatedAt`: 

### `ThreadMember`
*
 * スレッドをフォロー中のユーザーを管理するテーブル。通知を送信する対象

**Properties**
  - `threadId`: 
  - `userId`: 
  - `createdAt`: 

### `ChannelMember`

**Properties**
  - `userId`: 
  - `channelId`: 
  - `role`: 
  - `categoryId`: 
  - `displayOrder`: フォルダ内の表示順。同じフォルダ内で並び順の入れ替えが発生したときに更新する
  - `joinedAt`: 
  - `lastAccessedAt`: チャンネルに最後にアクセスした日時。既読の管理に使用

### `ChannelCategory`
*
 * ユーザーが作成したフォルダを管理するテーブル

**Properties**
  - `id`: 
  - `name`: 
  - `userId`: 
  - `workspaceId`: 
  - `createdAt`: 
  - `updatedAt`: 

### `Message`

**Properties**
  - `id`: 
  - `channelId`: 
  - `threadId`: 
  - `userId`: 
  - `content`: 
  - `type`: 
  - `createdAt`: 
  - `updatedAt`: 

### `Asset`

**Properties**
  - `id`: 
  - `messageId`: 
  - `alt`: アセットの代替テキスト。画像の場合はalt属性に相当
  - `type`: 
  - `url`: 
  - `createdAt`: 

### `Reaction`

**Properties**
  - `messageId`: 
  - `userId`: 
  - `emoji`: 絵文字の名前。例えば:smile:や:heart:など。Unicodeの絵文字とカスタム絵文字で管理方法が異なるため、relationはつけない
  - `createdAt`: 

### `PinnedMessage`

**Properties**
  - `channelId`: 
  - `messageId`: 
  - `pinnedBy`: 
  - `pinnedAt`: 

### `Bookmark`
*
 * ユーザーが個人的にメッセージを保存しておくためのブックマーク機能に使用するテーブル

**Properties**
  - `userId`: 
  - `messageId`: 
  - `createdAt`: 

### `Mention`

**Properties**
  - `messageId`: 
  - `mentionedUserId`: 
  - `createdAt`: 

### `CustomEmoji`

**Properties**
  - `id`: 
  - `workspaceId`: 
  - `name`: 
  - `url`: 
  - `createdAt`: 

### `MessageLink`

**Properties**
  - `id`: 
  - `messageId`: 
  - `url`: 
  - `title`: 
  - `description`: 
  - `ogImageUrl`: 
  - `createdAt`: 
  - `updatedAt`: 

### `_MessageToThread`
Pair relationship table between [Message](#Message) and [Thread](#Thread)

**Properties**
  - `A`: 
  - `B`: 